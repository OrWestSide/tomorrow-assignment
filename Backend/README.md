# tomorrow-challenge

Project description

## Prerequisites

* Docker
* Minikube
* Google Cloud SDK

## Installation
Clone the repository

    git clone git@gitlab.com:hapimag/microservices/tomorrow-challenge.git

## Usage
You can run the app in two different ways:

* Using `make`
    Run the following command in the terminal:

        make app

* Using `docker-compose`
    Run the following command in the terminal

        docker-compose run --rm --service-ports app

  > --rm flag is used optionally in order to delete the container when you wish to terminate it
  > --service-ports flag is used to bind container's port to your host system. Based on the docker-compose.yaml port 8888 of your system will be bound with port 80 in the container
  > Note: The first time execution of the command will take longer than usual since docker will have to build the image according to the Dockerfile instructions

  Navigate using your browser to [http://localhost:8888](http://localhost:8888/)

* Using `minikube`

    In order to run the app in minikube, we assume that you have minikube running and
    that the app is running in a pod. First, make docker point to the minikube docker engine:

        eval $(minikube docker-env)

    Then you need to build the image and tagging it properly. You can use the Makefile
    and run this command:

        make image

    Now a new pod will be created replacing the previous one when it is ready.

## Running the tests

* Using `make`
    Run the following command in the terminal:

        make tests

* Using `docker-compose`
    Run the following command in the terminal

        docker-compose run --rm tests

> --rm flag is used optionally in order to delete the container when tests are finished
> Note that apart from tests, pep8 and coverage checks will be also performed.

## Validating the code style

* Using `make`
    Run the following command in the terminal:

        make pep8

* Using `docker-compose`
    Run the following command in the terminal:

        docker-compose run --rm app flake8

## Package-management
Every main package is kept in `/requirements/requirements.txt`. Edit only this file to change the requirements of the platform. Later you will have to update the requirements for the container as well, which can be done in the following ways:

* Using `make`
    Run the following command in the terminal:

        make update_packages

* Using `docker-compose`
    Run the following command in the terminal:

        docker-compose run --rm upgrade

> After executing the command above the main packages and their dependencies will be freeze with the version number in `requirements-freezed.txt` file.
> This way we have better control and overview of the packages.

> IMPORTANT NOTE 1: `requirements-freezed.txt` is auto-generated by this command. Never edit this file directly.
> IMPORTANT NOTE 2: Always remember to rebuild the image after executing the command as described below
